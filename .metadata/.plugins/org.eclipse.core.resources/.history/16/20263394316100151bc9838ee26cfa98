"use strict";

function Vindu(path, method, parent) {
	this._width = 100;
	this._height = 100;
	this._path = path || null;
	this._parent = parent || null;
	this._method = method;
	this._thisVin = null;

}

//this.document.getElementById("submitMember").onclick = function() {
//var data = do_me.call(thisObj, id);
//put(id,data, thisObj);
//}	

Vindu.prototype.open = function() {
	try {
		this._thisVin = parent.window.open(this._path, 
				"Vindu", 
				"width=" + this._width,
				"height=" + this.height);

		var submit = (function(ctx) {
			ctx.document.getElementById("submitMember").onclick = function() {
				if(ctx.m == "PUT") this.update();
				else this.add();

				this.close();
			}
		}).bind(this);

		this._thisVin.addEventListener("DOMContentLoaded", submit, this, true);


	} catch(e) {
		console.log(e);
	}
}



Vindu.prototype.close = function() {
	try {
//		this.window.close();
		this._thisVin.window.close();
	} catch(e) {
		console.log(e);
	}
}

Vindu.prototype.update = function() {
	this._parent.put(this.getValues());
}

Vindu.prototype.add = function() {
	this._parent.post(this.getValues());
}

Vindu.prototype.getValues = function() {
	var fName = document.getElementById("fName").value;
	var lName = document.getElementById("fName").value;
	var address = document.getElementById("address").value;
	var phone = document.getElementById("fName").value;

	return {
		"firstname": fName,
		"lastname": lName,
		"address": address,
		"phone": phone
	};
}


